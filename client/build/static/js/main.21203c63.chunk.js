(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,function(t,e,n){t.exports=n(23)},,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),i=n(9),s=n.n(i),r=(n(16),n(7)),c=n(2),l=n(3),u=n(5),d=n(4),p=n(6),m=n(1),h=(n(17),n(18),n(19),function(t){function e(){var t;return Object(c.a)(this,e),(t=Object(u.a)(this,Object(d.a)(e).call(this))).state={isPulsing:!1},t}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t,e=this;return t=this.props.isSpeak?o.a.createElement("button",{type:"submit",id:"speech",className:"btn",onClick:function(t){e.setState({isPulsing:!e.state.isPulsing}),e.props.triggerAudioRecording()}},o.a.createElement("div",{className:this.state.isPulsing?"pulse-ring":""}),o.a.createElement("i",{className:"fa fa-microphone"})):o.a.createElement("button",{type:"submit",className:"btn btn-info"},"Add Item"),o.a.createElement("form",{onSubmit:function(t){e.props.submitHandlerList(t)}},o.a.createElement("label",null,o.a.createElement("input",{className:"form-control form-rounded",type:"text",name:"task",placeholder:"...order pizza",value:this.props.inputText,onChange:this.props.changeHandler})),o.a.createElement("div",null,t))}}]),e}(o.a.Component)),g=(n(20),function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props.list.map(function(e,n){return o.a.createElement("div",{key:n,className:"row list align-items-center"},o.a.createElement("div",{className:"col-md-6 col-6"},e.task),o.a.createElement("div",{className:"col-md-6 col-6 remove align-middle"},o.a.createElement("button",{value:n,className:"btn btn-outline-danger btn-sm",onClick:function(n){t.props.removeHandlerList(n,e.id)}},"Remove")))}).reverse();return o.a.createElement(o.a.Fragment,null,e)}}]),e}(o.a.Component)),b=(n(21),function(t){function e(){var t;return Object(c.a)(this,e),(t=Object(u.a)(this,Object(d.a)(e).call(this))).state={isPulsing:!1},t}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t,e=this;return t=this.props.isSpeak?o.a.createElement("button",{type:"submit",id:"speech",className:"btn",onClick:function(t){e.setState({isPulsing:!e.state.isPulsing}),e.props.triggerAudioRecording()}},o.a.createElement("div",{className:this.state.isPulsing?"pulse-ring":""}),o.a.createElement("i",{className:"fa fa-microphone"})):o.a.createElement("button",{type:"submit",className:"btn btn-info"},"Add Story"),o.a.createElement("span",null,o.a.createElement("form",{onSubmit:function(t){e.props.submitHandlerStory(t)}},o.a.createElement("label",null,o.a.createElement("textarea",{className:"form-control form-rounded",name:"words",placeholder:"...once upon a time",rows:"4",value:this.props.inputText,onChange:this.props.changeHandler})),o.a.createElement("div",null,t)))}}]),e}(o.a.Component)),f=(n(22),function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props.story.map(function(e,n){return o.a.createElement("div",{key:n,className:"row story align-items-center"},o.a.createElement("div",{className:"col-md-8 col-8"},e.words),o.a.createElement("div",{className:"col-md-4 col-4 remove"},o.a.createElement("button",{value:n,className:"btn btn-outline-danger btn-sm",onClick:function(n){t.props.removeHandlerStory(n,e.id)}},"Remove")))}).reverse();return o.a.createElement(o.a.Fragment,null,e)}}]),e}(o.a.Component)),S=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t,e,n,a=this;return this.props.isStory?(t="Story",n=o.a.createElement(f,{story:this.props.story,removeHandlerStory:this.props.removeHandlerStory}),e=o.a.createElement(b,{submitHandlerStory:function(t){a.props.submitHandlerStory(t)},changeHandler:function(t){a.props.changeHandler(t)},inputText:this.props.inputText,isSpeak:this.props.isSpeak,triggerAudioRecording:this.props.triggerAudioRecording})):(t="List",n=o.a.createElement(g,{list:this.props.list,removeHandlerList:this.props.removeHandlerList}),e=o.a.createElement(h,{submitHandlerList:function(t){a.props.submitHandlerList(t)},changeHandler:function(t){a.props.changeHandler(t)},inputText:this.props.inputText,isSpeak:this.props.isSpeak,triggerAudioRecording:this.props.triggerAudioRecording})),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-7"},o.a.createElement("div",{className:"title text-center"},t)),o.a.createElement("div",{className:"col-md-1"}),o.a.createElement("div",{className:"col-md-4"})),o.a.createElement("div",{className:"row outerwhole",display:"flex"},o.a.createElement("div",{className:"col-md-7 wholecontent"},n),o.a.createElement("div",{className:"col-md-1"}),o.a.createElement("div",{className:"col-md-4 text-center"},e)))}}]),e}(o.a.Component),y=function(t){function e(){return Object(c.a)(this,e),Object(u.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-8"}),o.a.createElement("div",{className:"col-md-4 flex-container"},o.a.createElement("div",{className:"togcapsule1 btn-group btn-group-toggle","data-toggle":"buttons"},o.a.createElement("label",{className:"btn btn-outline-light btn "+(this.props.isStory?"active":""),onClick:function(){return t.props.onStoryChanged("story")}},o.a.createElement("input",{type:"radio",name:"options",id:"optionStory",autoComplete:"off"})," Story"),o.a.createElement("label",{className:"btn btn-outline-light btn "+(this.props.isStory?"":"active"),onClick:function(){return t.props.onStoryChanged("list")}},o.a.createElement("input",{type:"radio",name:"options",id:"optionList",autoComplete:"off"})," List")),o.a.createElement("div",{className:"togcapsule2 btn-group btn-group-toggle","data-toggle":"buttons"},o.a.createElement("label",{className:"btn btn-outline-light btn "+(this.props.isSpeak?"active":""),onClick:function(){return t.props.onSpeakChanged("speak")}},o.a.createElement("input",{type:"radio",name:"options",id:"optionSpeak",autoComplete:"off"})," Speak"),o.a.createElement("label",{className:"btn btn-outline-light btn "+(this.props.isSpeak?"":"active"),onClick:function(){return t.props.onSpeakChanged("type")}},o.a.createElement("input",{type:"radio",name:"options",id:"optionType",autoComplete:"off"})," Type")))))}}]),e}(o.a.Component),v=function(t){function e(){var t;return Object(c.a)(this,e),(t=Object(u.a)(this,Object(d.a)(e).call(this))).state={list:[],deletedList:[],inputText:"",story:[],deletedStory:[],isStory:!0,isSpeak:!0,isRecordingStarted:!1,audioContext:null,myStream:null,scriptProcessor:null,audioSocket:null},t.submitHandlerList=t.submitHandlerList.bind(Object(m.a)(Object(m.a)(t))),t.removeHandlerList=t.removeHandlerList.bind(Object(m.a)(Object(m.a)(t))),t.changeHandler=t.changeHandler.bind(Object(m.a)(Object(m.a)(t))),t.submitHandlerStory=t.submitHandlerStory.bind(Object(m.a)(Object(m.a)(t))),t.removeHandlerStory=t.removeHandlerStory.bind(Object(m.a)(Object(m.a)(t))),t.onStoryChanged=t.onStoryChanged.bind(Object(m.a)(Object(m.a)(t))),t.onSpeakChanged=t.onSpeakChanged.bind(Object(m.a)(Object(m.a)(t))),t.triggerAudioRecording=t.triggerAudioRecording.bind(Object(m.a)(Object(m.a)(t))),t.startRecording=t.startRecording.bind(Object(m.a)(Object(m.a)(t))),t.streamAudioData=t.streamAudioData.bind(Object(m.a)(Object(m.a)(t))),t.stopAudioRecording=t.stopAudioRecording.bind(Object(m.a)(Object(m.a)(t))),t.initAndStartAudioRecording=t.initAndStartAudioRecording.bind(Object(m.a)(Object(m.a)(t))),t.setupAudioSocket=t.setupAudioSocket.bind(Object(m.a)(Object(m.a)(t))),t}return Object(p.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;Promise.all([fetch("/todos"),fetch("/story")]).then(function(t){var e=Object(r.a)(t,2),n=e[0],a=e[1];return Promise.all([n.json(),a.json()])}).then(function(e){var n=Object(r.a)(e,2),a=n[0],o=n[1];t.setState({list:a}),t.setState({story:o})})}},{key:"triggerAudioRecording",value:function(){this.state.isRecordingStarted?(this.stopAudioRecording(),this.setState({isRecordingStarted:!this.state.isRecordingStarted})):(this.initAndStartAudioRecording(),this.setState({isRecordingStarted:!this.state.isRecordingStarted}))}},{key:"stopAudioRecording",value:function(){this.state.myStream&&(this.state.myStream.getTracks()[0].stop(),this.setState({myStream:null})),this.state.scriptProcessor&&this.state.scriptProcessor.removeEventListener("audioprocess",this.streamAudioData),this.state.audioSocket&&(this.state.audioSocket.close(),this.setState({audioSocket:null}))}},{key:"initAndStartAudioRecording",value:function(){window.AudioContext=window.AudioContext||window.webkitAudioContext,navigator.mediaDevices.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"}}}).then(this.startRecording).catch(function(t){console.log(t)})}},{key:"startRecording",value:function(t,e){var n=window.AudioContext||window.webkitAudioContext;if(this.setState({audioContext:this.state.audioContext||new n({latencyHint:"interactive"})}),this.state.audioContext){var a=this.state.audioContext.createGain();this.setState({myStream:t,scriptProcessor:a.context.createScriptProcessor(2048,1,1)});var o=this.state.audioContext.createMediaStreamSource(this.state.myStream),i=this.state.audioContext.createAnalyser();o.connect(a),a.connect(i),a.connect(this.state.scriptProcessor),this.state.scriptProcessor.connect(a.context.destination),this.state.scriptProcessor.addEventListener("audioprocess",this.streamAudioData)}}},{key:"streamAudioData",value:function(t){this.state.audioSocket||this.setupAudioSocket();var e=t.inputBuffer.getChannelData(0);this.state.audioSocket.readyState===this.state.audioSocket.OPEN&&this.state.audioSocket.send(this.downsampleBuffer(e,44100,16e3))}},{key:"downsampleBuffer",value:function(t,e,n){if(n===e)return t;if(n>e){throw{code:418,message:"downsampling rate show be smaller than original sample rate"}}for(var a=e/n,o=Math.round(t.length/a),i=new Int16Array(o),s=0,r=0;s<i.length;){for(var c=Math.round((s+1)*a),l=0,u=0,d=r;d<c&&d<t.length;d++)l+=t[d],u++;i[s]=32767*Math.min(1,l/u),s++,r=c}return i.buffer}},{key:"setupAudioSocket",value:function(){var t=this;if(!this.state.audioSocket){var e=new WebSocket("ws://localhost:3002");e.onerror=function(t){console.log("audioSocket error",t)},e.onopen=function(){console.log("audioSocket open")},e.onclose=function(){console.log("audioSocket closed")},e.onmessage=function(e){t.setState({inputText:t.state.inputText+e.data.substr(1).slice(0,-1)})},this.setState({audioSocket:e})}}},{key:"changeHandler",value:function(t){this.setState({inputText:t.target.value})}},{key:"submitHandlerList",value:function(t){var e=this.state.list,n=t.target.task.value;if(t.preventDefault(),n.length>1){e.push({task:n}),this.setState({list:e,inputText:""});var a={task:n};fetch("/todos",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){return console.log("Success:",JSON.stringify(t))}).catch(function(t){return console.error("Error:",t)})}else this.setState({inputText:""})}},{key:"submitHandlerStory",value:function(t){var e=this.state.story,n=t.target.words.value;if(t.preventDefault(),n.length>1){e.push({words:n}),this.setState({story:e,inputText:""});var a={words:n};fetch("/story",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){return console.log("Success:",JSON.stringify(t))}).catch(function(t){return console.error("Error:",t)})}else this.setState({inputText:""})}},{key:"removeHandlerList",value:function(t,e){var n=t.target.value,a=this.state.list,o=this.state.deletedList;o.push(a[n]),a.splice(n,1),this.setState({list:a,deletedList:o}),fetch("/todos/".concat(e,"/delete"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(t){return t.json()}).then(function(t){return console.log(t)})}},{key:"removeHandlerStory",value:function(t,e){var n=t.target.value,a=this.state.story,o=this.state.deletedStory;o.push(a[n]),a.splice(n,1),this.setState({story:a,deletedStory:o}),fetch("/story/".concat(e,"/delete"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(t){return t.json()}).then(function(t){return console.log(t)})}},{key:"onStoryChanged",value:function(t){this.setState({isStory:"story"===t})}},{key:"onSpeakChanged",value:function(t){this.setState({isSpeak:"speak"===t})}},{key:"render",value:function(){var t=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"heading text-center"},o.a.createElement("img",{src:"/images/logo.png",width:"140",height:"150",alt:"logo"})),o.a.createElement("div",{className:"container mainbox"},o.a.createElement(y,{isStory:this.state.isStory,isSpeak:this.state.isSpeak,onStoryChanged:this.onStoryChanged,onSpeakChanged:this.onSpeakChanged}),o.a.createElement(S,{isStory:this.state.isStory,isSpeak:this.state.isSpeak,list:this.state.list,removeHandlerList:this.removeHandlerList,submitHandlerList:function(e){t.submitHandlerList(e)},changeHandler:function(e){t.changeHandler(e)},inputText:this.state.inputText,story:this.state.story,removeHandlerStory:this.removeHandlerStory,submitHandlerStory:function(e){t.submitHandlerStory(e)},triggerAudioRecording:this.triggerAudioRecording})),o.a.createElement("div",{className:"footer"},o.a.createElement("div",{className:"copyright"},"Copyright \xa9 2019 Claucanchin, Inc. All rights reserved."),o.a.createElement("p",null,"Terms of Use | Privacy Policy")))}}]),e}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[10,1,2]]]);
//# sourceMappingURL=main.21203c63.chunk.js.map